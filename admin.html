<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Joker AI ‚ô† Admin</title>

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600&family=Playfair+Display&display=swap" rel="stylesheet">

<style>
:root{
  --gold:#d4b46a;
  --gold-soft:#e6c87a;
  --bg:#050302;
}

*{box-sizing:border-box}

body{
  margin:0;
  background:#000;
  color:#f3e6c8;
  font-family:'Playfair Display',serif;
}

header{
  padding:22px;
  text-align:center;
  font-family:'Cinzel',serif;
  font-size:22px;
  color:var(--gold);
  border-bottom:1px solid rgba(212,180,106,.3);
}

.status-bar{
  text-align:center;
  margin-top:10px;
  font-family:'Cinzel',serif;
  font-size:13px;
}

.status.online{color:#7CFF7C}
.status.offline{color:#FF7C7C}
.status.maintenance{color:#FFD27C}

/* actions */
.actions{
  display:flex;
  flex-wrap:wrap;
  gap:12px;
  justify-content:center;
  padding:18px;
}

button{
  background:linear-gradient(135deg,var(--gold-soft),#9c7c2f);
  border:none;
  padding:12px 20px;
  border-radius:20px;
  cursor:pointer;
  font-family:'Cinzel',serif;
  color:#1b1208;
  transition:.3s;
}
button:hover{transform:scale(1.05)}

.logs{
  max-width:960px;
  margin:20px auto 40px;
  padding:0 16px;
}

.log{
  background:rgba(212,180,106,.08);
  border:1px solid rgba(212,180,106,.25);
  border-radius:16px;
  padding:16px;
  margin-bottom:16px;
  animation:fade .3s ease;
}

.meta{
  font-size:12px;
  color:rgba(212,180,106,.85);
  margin-bottom:10px;
  font-family:'Cinzel',serif;
}

.block{
  margin-bottom:10px;
}

.label{
  font-size:11px;
  color:var(--gold);
  margin-bottom:4px;
}

.msg{
  background:rgba(0,0,0,.35);
  padding:10px 14px;
  border-radius:12px;
  font-size:14px;
  line-height:1.5;
}

@keyframes fade{
  from{opacity:0;transform:translateY(6px)}
  to{opacity:1}
}
</style>
</head>

<body>

<header>
  üÉè Joker AI ‚ô† ‚Äî Admin
  <div class="status-bar">
    Status atual:
    <span id="statusLabel" class="status">‚óè</span>
  </div>
</header>

<div class="actions">
  <button onclick="setStatus('online')">üü¢ Online</button>
  <button onclick="setStatus('maintenance')">üü° Manuten√ß√£o</button>
  <button onclick="setStatus('offline')">üî¥ Offline</button>
  <button onclick="loadLogs()">üîÑ Atualizar Logs</button>
</div>

<div class="logs" id="logs"></div>

<script>
/* ================= STATUS ================= */

const STATUS_KEY = "joker_status";
const statusLabel = document.getElementById("statusLabel");

function setStatus(type){
  localStorage.setItem(STATUS_KEY, type);
  updateStatusUI(type);
  logAdmin(`Status alterado para ${type.toUpperCase()}`);
}

function getStatus(){
  return localStorage.getItem(STATUS_KEY) || "online";
}

function updateStatusUI(type){
  let text = "‚óè ";
  let cls = "status ";

  if(type === "online"){
    text += "Online";
    cls += "online";
  }
  if(type === "offline"){
    text += "Offline";
    cls += "offline";
  }
  if(type === "maintenance"){
    text += "Manuten√ß√£o";
    cls += "maintenance";
  }

  statusLabel.textContent = text;
  statusLabel.className = cls;
}

updateStatusUI(getStatus());

/* ================= LOGS ================= */

function logAdmin(text){
  const logs = JSON.parse(localStorage.getItem("joker_admin_logs") || "[]");

  logs.unshift({
    time: new Date().toLocaleString(),
    ip: "ADMIN",
    message: "Painel Administrativo",
    reply: text,
    ua: navigator.userAgent
  });

  localStorage.setItem("joker_admin_logs", JSON.stringify(logs));
}

async function loadLogs(){
  const container = document.getElementById("logs");
  container.innerHTML = "";

  let serverLogs = [];

  // tenta carregar logs do backend (se existir)
  try{
    const params = new URLSearchParams(window.location.search);
    const key = params.get("key");
    if(key){
      const res = await fetch(`/logs?key=${key}`);
      serverLogs = await res.json();
    }
  }catch{}

  const adminLogs = JSON.parse(localStorage.getItem("joker_admin_logs") || "[]");
  const all = [...adminLogs, ...serverLogs];

  if(all.length === 0){
    container.innerHTML = "<div class='log'>Nenhum log encontrado.</div>";
    return;
  }

  all.forEach(log=>{
    const div = document.createElement("div");
    div.className = "log";
    div.innerHTML = `
      <div class="meta">${log.time} ‚Ä¢ ${log.ip}</div>

      <div class="block">
        <div class="label">Mensagem</div>
        <div class="msg">${log.message}</div>
      </div>

      <div class="block">
        <div class="label">Detalhe</div>
        <div class="msg">${log.reply}</div>
      </div>

      <div class="meta">${log.ua}</div>
    `;
    container.appendChild(div);
  });
}

loadLogs();
</script>

</body>
</html>